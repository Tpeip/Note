<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<button onclick="printData()">打印</button>
	<div id="content">
		<table>
			<tr>
				<td>序号</td>
				<td>姓名</td>
				<td>性别</td>
				<td>年龄</td>
				<td>成绩</td>
			</tr>
			<tr>
				<td>1</td>
				<td>张三</td>
				<td>男</td>
				<td>20</td>
				<td>99</td>
			</tr>
		</table>
	</div>
</body>
<script type="text/javascript" src="Lodop6.226_Clodop3.093/LodopFuncs.js"></script>
<script type="text/javascript">
	function printData(){
		var userAgent = navigator.userAgent.toLowerCase(); //取得浏览器的userAgent字符串
		if (userAgent.indexOf("trident") > -1){
			alert("请使用google或者360浏览器打印");
			return false;
		}
		else if(userAgent.indexOf('msie')>-1){ 
			var onlyChoseAlert = simpleAlert({
	           "content":"请使用Google或者360浏览器打印",
	           "buttons":{
	               "确定":function () {
	                   onlyChoseAlert.close();
	               }
	           }
	       })
			alert("请使用google或者360浏览器打印");
			return false;
		}
		else{//其它浏览器使用lodop
			/*var oldstr = document.body.innerHTML; 
			var headstr = '<html><head><title></title></head><body>';  
			var bodystr = '<div><table class="default-tab" style="width:100%;font-size:10px;border-collapse:collapse" border="1">';
			bodystr += 
			bodystr +=	"</tbody></table></div>"
			var footstr = "</body>"; */
			var LODOP = getLodop();
			LODOP.PRINT_INIT("");
			LODOP.SET_PRINT_STYLE("Alignment",3);
			LODOP.SET_PRINT_STYLE("FontSize",8);
			LODOP.SET_PRINT_PAGESIZE(3,'82mm','10mm','');
			LODOP.ADD_PRINT_HTM('5mm','2mm',"68mm","50mm",document.getElementById('content').innerHTML);
			//打印预览
			LODOP.PREVIEW();
			//直接打印
			LODOP.PRINT();
		}
	}
</script>
</html>